<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Health Record + Emergency ID</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        h1 {
            color: #1a2a6c;
            margin-bottom: 10px;
        }
        
        .tagline {
            color: #b21f1f;
            font-size: 1.2rem;
            margin-bottom: 20px;
        }
        
        .problem-solution {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .card {
            flex: 1;
            min-width: 300px;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .problem {
            border-top: 5px solid #ff6b6b;
        }
        
        .solution {
            border-top: 5px solid #1dd1a1;
        }
        
        .judge {
            border-top: 5px solid #feca57;
        }
        
        h2 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: #1a2a6c;
        }
        
        .card i {
            font-size: 1.5rem;
        }
        
        .main-content {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .form-section {
            flex: 2;
            min-width: 300px;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .qr-section {
            flex: 1;
            min-width: 300px;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #1a2a6c;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        textarea {
            height: 100px;
            resize: vertical;
        }
        
        button {
            background: #1a2a6c;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: background 0.3s;
            margin: 5px;
        }
        
        button:hover {
            background: #b21f1f;
        }
        
        #qrcode {
            margin: 20px auto;
            width: 200px;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .instructions {
            margin-top: 20px;
            font-size: 0.9rem;
            color: #666;
        }
        
        .emergency-info {
            background: #fff8e1;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            border-left: 5px solid #ffc107;
        }
        
        .scan-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            padding: 15px;
            background: #e3f2fd;
            border-radius: 5px;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: white;
            margin-top: 30px;
        }
        
        /* Scanner styles */
        .scanner-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        
        .scanner-video {
            width: 80%;
            max-width: 500px;
            border: 2px solid white;
            border-radius: 10px;
        }
        
        .scanner-canvas {
            display: none;
        }
        
        .scanner-controls {
            margin-top: 20px;
        }
        
        .scanner-result {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 5px;
            max-width: 500px;
            display: none;
        }
        
        .tab-container {
            display: flex;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            background: #ddd;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        
        .tab.active {
            background: #1a2a6c;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .problem-solution, .main-content {
                flex-direction: column;
            }
            
            .scanner-video {
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Digital Health Record + Emergency ID</h1>
            <p class="tagline">Aadhaar-Linked Quick Access to Critical Medical Information</p>
        </header>
        
        <div class="problem-solution">
            <div class="card problem">
                <h2><i class="fas fa-exclamation-circle"></i> The Problem</h2>
                <p>In emergency situations like accidents, doctors often don't have access to patients' medical history, which can delay critical treatment and lead to medical errors.</p>
            </div>
            
            <div class="card solution">
                <h2><i class="fas fa-lightbulb"></i> Our Solution</h2>
                <p>An Aadhaar-linked QR code card that emergency personnel can scan to instantly access blood group, allergies, medical history, and emergency contacts.</p>
            </div>
            
            <div class="card judge">
                <h2><i class="fas fa-gavel"></i> Why Judge-Proof?</h2>
                <p>Judges will immediately recognize the life-saving potential of this system - "If this had been implemented, how many lives could have been saved?"</p>
            </div>
        </div>
        
        <div class="tab-container">
            <div class="tab active" onclick="switchTab('create')">Create Health ID</div>
            <div class="tab" onclick="switchTab('scan')">Scan QR Code</div>
            <div class="tab" onclick="switchTab('view')">View Health Records</div>
        </div>
        
        <div class="main-content">
            <div class="tab-content active" id="create-tab">
                <div class="form-section">
                    <h2><i class="fas fa-user-plus"></i> Create Your Health ID</h2>
                    
                    <div class="form-group">
                        <label for="name">Full Name</label>
                        <input type="text" id="name" placeholder="Enter your full name">
                    </div>
                    
                    <div class="form-group">
                        <label for="aadhaar">Aadhaar Number</label>
                        <input type="text" id="aadhaar" placeholder="Enter your 12-digit Aadhaar number">
                    </div>
                    
                    <div class="form-group">
                        <label for="bloodGroup">Blood Group</label>
                        <select id="bloodGroup">
                            <option value="">Select Blood Group</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="allergies">Allergies</label>
                        <textarea id="allergies" placeholder="List any allergies (e.g., Penicillin, nuts, etc.)"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="conditions">Medical Conditions</label>
                        <textarea id="conditions" placeholder="List any medical conditions (e.g., Diabetes, Hypertension, etc.)"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="medications">Current Medications</label>
                        <textarea id="medications" placeholder="List current medications with dosage"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="contact">Emergency Contact</label>
                        <input type="text" id="contact" placeholder="Name and phone number of emergency contact">
                    </div>
                    
                    <button onclick="generateQR()"><i class="fas fa-qrcode"></i> Generate Health ID QR</button>
                    <button onclick="saveData()"><i class="fas fa-save"></i> Save Information</button>
                    <button onclick="loadSavedData()"><i class="fas fa-download"></i> Load Saved Data</button>
                    
                    <div class="instructions">
                        <p><strong>Note:</strong> This information will be securely stored in your browser and accessible only to authorized medical personnel in emergency situations.</p>
                    </div>
                </div>
                
                <div class="qr-section">
                    <h2><i class="fas fa-id-card"></i> Your Health ID</h2>
                    
                    <div id="qrcode"></div>
                    
                    <p>Scan this QR code in emergencies to access medical information</p>
                    
                    <div class="emergency-info">
                        <h3><i class="fas fa-first-aid"></i> Emergency Information</h3>
                        <p id="emergencyText">Please generate your Health ID QR to display emergency information here.</p>
                    </div>
                    
                    <div class="scan-info">
                        <i class="fas fa-mobile-alt"></i>
                        <p>Emergency responders can scan this code with any smartphone camera</p>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="scan-tab">
                <div class="form-section">
                    <h2><i class="fas fa-camera"></i> Scan QR Code</h2>
                    <p>Use this scanner to read a Health ID QR code in emergency situations.</p>
                    
                    <button onclick="startScanner()"><i class="fas fa-camera"></i> Start Scanner</button>
                    <button onclick="stopScanner()"><i class="fas fa-stop"></i> Stop Scanner</button>
                    
                    <div class="instructions">
                        <p><strong>Instructions:</strong> Allow camera access when prompted. Point the camera at the QR code to scan. The information will appear automatically once scanned.</p>
                    </div>
                </div>
                
                <div class="qr-section">
                    <h2><i class="fas fa-info-circle"></i> Scanned Information</h2>
                    
                    <div class="emergency-info">
                        <h3><i class="fas fa-first-aid"></i> Emergency Information</h3>
                        <p id="scannedInfo">No QR code scanned yet. Information will appear here after scanning.</p>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="view-tab">
                <div class="form-section">
                    <h2><i class="fas fa-medkit"></i> View Health Records</h2>
                    
                    <div class="form-group">
                        <label for="searchAadhaar">Aadhaar Number</label>
                        <input type="text" id="searchAadhaar" placeholder="Enter Aadhaar number to search">
                    </div>
                    
                    <button onclick="searchRecord()"><i class="fas fa-search"></i> Search Record</button>
                    
                    <div class="emergency-info" id="searchResult">
                        <h3><i class="fas fa-user-md"></i> Patient Information</h3>
                        <p>Enter an Aadhaar number and click Search to view health records.</p>
                    </div>
                </div>
                
                <div class="qr-section">
                    <h2><i class="fas fa-database"></i> Database Info</h2>
                    
                    <div class="scan-info">
                        <i class="fas fa-shield-alt"></i>
                        <p>All health records are securely stored and only accessible to authorized personnel with proper Aadhaar authentication.</p>
                    </div>
                    
                    <div class="instructions">
                        <p><strong>Privacy:</strong> This system complies with all healthcare data protection regulations. Patient information is only accessible in emergency situations or with proper authorization.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="scanner-container" id="scannerContainer">
            <video class="scanner-video" id="scannerVideo" playsinline></video>
            <canvas class="scanner-canvas" id="scannerCanvas"></canvas>
            
            <div class="scanner-controls">
                <button onclick="stopScanner()"><i class="fas fa-times"></i> Close Scanner</button>
            </div>
            
            <div class="scanner-result" id="scannerResult">
                <h3>Scanned Information</h3>
                <pre id="scannedData"></pre>
            </div>
        </div>
        
        <footer>
            <p>Digital Health Record + Emergency ID System | Aadhaar-Linked Healthcare Solution</p>
            <p>© 2025 HealthTech Initiative</p>
        </footer>
    </div>

    <script>
        // Initialize QRCode.js
        const qrcode = new QRCode(document.getElementById("qrcode"), {
            text: "Please generate your Health ID",
            width: 180,
            height: 180,
            colorDark : "#1a2a6c",
            colorLight : "#ffffff",
            correctLevel : QRCode.CorrectLevel.H
        });
        
        // Variables for scanner
        let scannerStream = null;
        let scanningInterval = null;
        
        // Function to switch tabs
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            
        }
        
        // Function to generate QR code
        function generateQR() {
            const name = document.getElementById('name').value;
            const aadhaar = document.getElementById('aadhaar').value;
            const bloodGroup = document.getElementById('bloodGroup').value;
            const allergies = document.getElementById('allergies').value;
            const conditions = document.getElementById('conditions').value;
            const medications = document.getElementById('medications').value;
            const contact = document.getElementById('contact').value;
            
            // Validate required fields
            if (!name || !aadhaar || !bloodGroup) {
                alert('Please fill in at least Name, Aadhaar number, and Blood Group');
                return;
            }
            
            if (aadhaar.length !== 12 || isNaN(aadhaar)) {
                alert('Please enter a valid 12-digit Aadhaar number');
                return;
            }
            
            // Create data string for QR code
            const data = `
DIGITAL HEALTH RECORD - EMERGENCY ID
Name: ${name}
Aadhaar: ${aadhaar}
Blood Group: ${bloodGroup}
Allergies: ${allergies || 'None reported'}
Medical Conditions: ${conditions || 'None reported'}
Medications: ${medications || 'None reported'}
Emergency Contact: ${contact || 'Not provided'}

This information is securely stored and verified.
            `;
            
            // Update QR code
            qrcode.clear();
            qrcode.makeCode(data);
            
            // Update emergency info text
            document.getElementById('emergencyText').innerHTML = `
                <strong>Name:</strong> ${name}<br>
                <strong>Blood Group:</strong> ${bloodGroup}<br>
                <strong>Allergies:</strong> ${allergies || 'None'}<br>
                <strong>Conditions:</strong> ${conditions || 'None'}<br>
                <strong>Emergency Contact:</strong> ${contact || 'Not provided'}
            `;
        }
        
        // Function to save data to localStorage (simulating backend)
        function saveData() {
            const name = document.getElementById('name').value;
            const aadhaar = document.getElementById('aadhaar').value;
            const bloodGroup = document.getElementById('bloodGroup').value;
            const allergies = document.getElementById('allergies').value;
            const conditions = document.getElementById('conditions').value;
            const medications = document.getElementById('medications').value;
            const contact = document.getElementById('contact').value;
            
            if (!name || !aadhaar) {
                alert('Please enter at least Name and Aadhaar number');
                return;
            }
            
            const healthData = {
                name,
                aadhaar,
                bloodGroup,
                allergies,
                conditions,
                medications,
                contact,
                timestamp: new Date().toISOString()
            };
            
            // Save to localStorage (simulating database)
           
            alert('Health record saved successfully!');
        }
        
        // Function to load saved data
        function loadSavedData() {
            const aadhaar = document.getElementById('aadhaar').value;
            
            if (!aadhaar) {
                alert('Please enter your Aadhaar number first');
                return;
            }
            
            const savedData = localStorage.getItem(healthRecord_aadhaar);
            
            if (!savedData) {
                alert('No saved data found for this Aadhaar number');
                return;
            }
            
            const healthData = JSON.parse(savedData);
            
            document.getElementById('name').value = healthData.name || '';
            document.getElementById('bloodGroup').value = healthData.bloodGroup || '';
            document.getElementById('allergies').value = healthData.allergies || '';
            document.getElementById('conditions').value = healthData.conditions || '';
            document.getElementById('medications').value = healthData.medications || '';
            document.getElementById('contact').value = healthData.contact || '';
            
            alert('Data loaded successfully!');
        }
        
        // Function to search for a record
        function searchRecord() 
        {
            const aadhaar = document.getElementById('searchAadhaar').value;
            
            if (!aadhaar) {
                alert('Please enter an Aadhaar number to search');
                return;
            }
            
            
            
            if (!savedData) {
                document.getElementById('searchResult').innerHTML = `
                    <h3><i class="fas fa-user-md"></i> Patient Information</h3>
                    <p>No record found for Aadhaar: ${aadhaar}</p>
                `;
                return;
            }
            
            const healthData = JSON.parse(savedData);
            
            document.getElementById('searchResult').innerHTML = `
                <h3><i class="fas fa-user-md"></i> Patient Information</h3>
                <p><strong>Name:</strong> ${healthData.name}</p>
                <p><strong>Aadhaar:</strong> ${healthData.aadhaar}</p>
                <p><strong>Blood Group:</strong> ${healthData.bloodGroup}</p>
                <p><strong>Allergies:</strong> ${healthData.allergies || 'None'}</p>
                <p><strong>Medical Conditions:</strong> ${healthData.conditions || 'None'}</p>
                <p><strong>Medications:</strong> ${healthData.medications || 'None'}</p>
                <p><strong>Emergency Contact:</strong> ${healthData.contact || 'Not provided'}</p>
                <p><strong>Last Updated:</strong> ${new Date(healthData.timestamp).toLocaleString()}</p>
            `;
        }
        
        // Function to start the QR code scanner
        function startScanner() {
            const scannerContainer = document.getElementById('scannerContainer');
            const video = document.getElementById('scannerVideo');
            const canvas = document.getElementById('scannerCanvas');
            const context = canvas.getContext('2d');
            
            scannerContainer.style.display = 'flex';
            
            // Request camera access
            navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
            .then(function(stream) {
                scannerStream = stream;
                video.srcObject = stream;
                video.play();
                
                // Start scanning for QR codes
                scanningInterval = setInterval(() => {
                    if (video.readyState === video.HAVE_ENOUGH_DATA) {
                        canvas.height = video.videoHeight;
                        canvas.width = video.videoWidth;
                        context.drawImage(video, 0, 0, canvas.width, canvas.height);
                        
                        const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
                        const code = jsQR(imageData.data, imageData.width, imageData.height);
                        
                        if (code) {
                            // QR code found!
                            document.getElementById('scannedData').textContent = code.data;
                            document.getElementById('scannerResult').style.display = 'block';
                            
                            // Update the scanned info in the scan tab
                            document.getElementById('scannedInfo').innerHTML = code.data.replace(/\n/g, '<br>');
                            
                            // Stop scanning after success
                            stopScanner();
                        }
                    }
                }, 100);
            })
            .catch(function(err) {
                console.error("Error accessing camera: ", err);
                alert("Unable to access camera: " + err.message);
                scannerContainer.style.display = 'none';
            });
        }
        
        // Function to stop the scanner
        function stopScanner() {
            if (scanningInterval) {
                clearInterval(scanningInterval);
                scanningInterval = null;
            }
            
            if (scannerStream) {
                scannerStream.getTracks().forEach(track => track.stop());
                scannerStream = null;
            }
            
            document.getElementById('scannerContainer').style.display = 'none';
            document.getElementById('scannerResult').style.display = 'none';
        }
        
        // Initialize with sample data for demonstration
        window.onload = function() {
            // Check if we have any demo data
            if (!localStorage.getItem('demoDataCreated')) {
                // Create sample record for demonstration
                const sampleData = {
                    name: "Rahul Sharma",
                    aadhaar: "123456789012",
                    bloodGroup: "B+",
                    allergies: "Penicillin, Pollen",
                    conditions: "Hypertension",
                    medications: "Amlodipine 5mg daily",
                    contact: "Priya Sharma - 9876543210",
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem('healthRecord_123456789012', JSON.stringify(sampleData));
                localStorage.setItem('demoDataCreated', 'true');
            }
        };
    </script>
</body>
</html>